# Todolist 网站项目需求文档（MVP）

## 目标
实现 Todo 任务的创建、读取、更新、删除（CRUD），并提供基础的筛选与状态管理。

## 范围
前后端一体的最小可用版本（MVP），包含数据持久化、基础校验与简单 UI。

## 角色
普通用户（无登录），后续如需多用户再扩展。

## 功能需求
### 1. 创建任务
- 字段：
  - title（必填，≤100 字符）
  - description（选填，≤1000 字符）
  - status（枚举：`todo` | `in_progress` | `done`，默认 `todo`）
  - dueDate（选填，ISO 日期）
  - priority（枚举：`low` | `medium` | `high`，默认 `medium`）
- 行为：表单提交后新增任务，返回新任务详情，前端列表即时更新。
- 校验：必填字段非空；字符长度与枚举合法。

### 2. 查询任务（列表与详情）
- 列表：分页（默认每页 20）、排序（默认按创建时间倒序）、筛选（按 status、priority、文本搜索于 title/description）。
- 详情：点击列表项查看完整字段。
- 空态与加载态：显示提示与骨架屏。

### 3. 更新任务
- 可编辑字段：title、description、status、dueDate、priority。
- 支持局部更新（PATCH）；更新成功后列表项与详情同步刷新。

### 4. 删除任务
- 单条删除：操作前二次确认。
- 批量删除：多选后统一删除（MVP 可选，若时间紧先不做批量）。

### 5. 任务状态切换快捷操作
- 列表内可快速切换 status（如从 `todo` → `done`）。

### 6. 本地缓存与重试（可选）
- 前端对最近一次列表结果进行本地缓存；网络失败时提示并支持重试。

## 非功能需求
- 可用性：简洁直观，关键操作有反馈与确认。
- 性能：列表分页与服务端过滤，避免一次性加载过多数据。
- 安全（防御性）：
  - 输入校验与服务端端到端验证。
  - 防止基础的注入：参数化查询或 ORM；对输出进行适当转义。
  - 速率限制（简单级别）与错误码合理返回。
- 可维护性：API 与前端状态管理结构清晰；错误处理统一。

## API 规范（MVP）
- POST `/api/todos`
  - body: `{ title, description?, status?, dueDate?, priority? }`
  - 201: `{ id, ...fields, createdAt, updatedAt }`
- GET `/api/todos`
  - query: `{ page?, pageSize?, sortBy?=createdAt, sortOrder?=desc, status?, priority?, q? }`
  - 200: `{ items: Todo[], page, pageSize, total }`
- GET `/api/todos/:id`
  - 200: `Todo`
- PATCH `/api/todos/:id`
  - body: 局部字段
  - 200: 更新后的 `Todo`
- DELETE `/api/todos/:id`
  - 204

## 数据模型
```ts
interface Todo {
  id: string | number;         // 后端生成
  title: string;
  description?: string;
  status: 'todo' | 'in_progress' | 'done';
  dueDate?: string;            // ISO8601
  priority: 'low' | 'medium' | 'high';
  createdAt: string;           // ISO8601
  updatedAt: string;           // ISO8601
}
```

## 前端要求
- 页面：任务列表页、任务创建/编辑表单、任务详情（可为抽屉或独立页）。
- 交互：加载中、空态、错误提示；状态切换与删除确认。
- 状态管理：集中管理（如 Redux/Context）或基于框架的查询库（如 React Query）。
- 表单校验：同步前端校验 + 失败时展示后端错误。

## 后端要求
- 持久化：使用本地数据库或文件存储（如 SQLite / JSON 文件，视项目结构而定）。
- 结构：分层（路由/控制器/服务/数据层），统一错误处理中间件。
- 校验：请求体与查询参数校验（如使用 schema 验证）。
- 日志：基础访问日志与错误日志。
- 测试（可选）：核心服务层的单元测试。

## 部署与运行
- 开发：前后端分别启动，提供 `.env` 配置端口；统一跨域设置（CORS）。
- 构建：前端打包；后端启动脚本。
- 监控（可选）：简单健康检查 `GET /api/health`。

## 里程碑
- M1：后端 API 打底（CRUD + 校验）。
- M2：前端列表页 + 创建/编辑表单。
- M3：筛选/分页与状态快捷切换。
- M4（可选）：批量删除、本地缓存、基础测试。
